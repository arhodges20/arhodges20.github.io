const notebookData = {
  "attacker-objectives": {
    "credential-access": {
      "coverage": {
        "path": "attacker-objectives\\credential-access\\coverage.md",
        "content": "# Coverage: Credential Access\n\n| ATT&CK Technique | Detection(s) | Data Source | Confidence | Notes / Gaps |\n|---|---|---|---|---|\n| T1003 OS Credential Dumping | (planned) | Sysmon / EDR | Low (initial) | Need specific LSASS access visibility + test cases |\n| T1110 Brute Force | (planned) | Entra sign-in logs | Medium | Need thresholds + exceptions for legit patterns |\n| T1555 Credentials from Password Stores | (planned) | Sysmon / EDR | Low | Requires identifying common tooling + access patterns |\n| T1059.001 PowerShell | `Suspicious PowerShell EncodedCommand` (implemented) | Sysmon + PS logs | Medium | Generic execution signal that can support credential access; not credential-theft-specific alone |\n\n"
      },
      "detections": {
        "README": {
          "path": "attacker-objectives\\credential-access\\detections\\README.md",
          "content": "# Detections (Credential Access)\n\nThis directory will hold detections implemented in:\n- Sigma (portable)\n- SPL (Splunk)\n- KQL (Defender / Sentinel style)\n\nEach detection should include:\n- ATT&CK mapping\n- Required telemetry\n- Detection logic\n- Why it works\n- Limitations / false positives\n- Validation notes\n\n"
        },
        "suspicious-powershell-encodedcommand": {
          "path": "attacker-objectives\\credential-access\\detections\\suspicious-powershell-encodedcommand.md",
          "content": "# Detection: Suspicious PowerShell EncodedCommand\n\n## ATT&CK Mapping\n- T1059.001 – PowerShell\n\n## Attacker Behavior\nAttackers frequently use Base64-encoded PowerShell commands to:\n- Obfuscate intent\n- Evade simple string-based detections\n- Deliver payloads filelessly\n- Deliver or stage credential-theft tooling (e.g., Invoke-Mimikatz) using execution that enables credential access rather than being the objective itself.\n\nThis is commonly observed during credential access, initial access staging, and post-exploitation; here it is tracked as an execution signal that supports the Credential Access objective.\n\n---\n\n## Required Telemetry\n### Windows Endpoint\n- Process creation events\n  - Sysmon Event ID 1 **or**\n  - Windows Security Event ID 4688\n- Command-line logging enabled\n\n---\n\n## Detection Hypothesis\nIf an attacker is executing obfuscated PowerShell commands, we will observe:\n- `powershell.exe` or `pwsh.exe`\n- The `-EncodedCommand` or `-enc` argument\n- Often launched from non-interactive or unusual parent processes\n\n---\n\n## Detection Logic (Generic)\nTrigger when:\n- Process name is `powershell.exe` or `pwsh.exe`\n- Command line contains:\n  - `-EncodedCommand` OR\n  - `-enc`\n\n---\n\n## Example Sigma Logic (Simplified)\n\n```yaml\ntitle: Suspicious PowerShell EncodedCommand\nstatus: experimental\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    Image|endswith:\n      - '\\powershell.exe'\n      - '\\pwsh.exe'\n    CommandLine|contains:\n      - '-EncodedCommand'\n      - '-enc'\n  condition: selection\nlevel: medium\n\n---\n\n## Limitations / Blind Spots (linked to threat model assumptions)\n- Depends on threat model assumptions about telemetry availability (process creation logging and, ideally, PowerShell logging); without these, detection quality degrades.\n- Evasion via renamed binaries, Living-off-the-Land execution, or EDR bypass techniques aligns with threat-model blind spots; this rule will miss such cases.\n- This is a generic execution signal and not credential-theft-specific by itself; additional context is required to confirm Credential Access intent.\n\n"
        }
      },
      "README": {
        "path": "attacker-objectives\\credential-access\\README.md",
        "content": "# Attacker Objective: Credential Access\n\n## Goal\nDetect behavior associated with an adversary attempting to obtain credentials on Windows endpoints and/or in cloud identity systems.\n\n## Why this matters\nCredential theft is a common pivot point that enables privilege escalation, lateral movement, persistence, and data access.\n\n## What’s included\n- Threat model and ATT&CK mapping\n- Coverage tracking (what is detected vs. gaps)\n- Detections (initial set)\n"
      },
      "threat-model": {
        "path": "attacker-objectives\\credential-access\\threat-model.md",
        "content": "# Threat Model: Credential Access\n\n## Attacker objective\nObtain user credentials (passwords, hashes, tokens, session material) to enable account takeover and access to systems/services.\n\n## Common techniques (MITRE ATT&CK)\n- T1003: OS Credential Dumping\n- T1110: Brute Force (password spraying / guessing)\n- T1555: Credentials from Password Stores\n- T1059.001: PowerShell (often used to stage/execute credential theft)\n- T1552: Unsecured Credentials (configs, scripts, files)\n\n## Telemetry required (minimum viable)\n### Windows endpoint\n- Process creation (command line + parent/child): Sysmon Event ID 1 or Windows Security 4688\n- (Optional but strong) PowerShell logging: Script Block Logging (4104), Module logging\n- (Optional) LSASS access telemetry (Sysmon Event ID 10 if configured, or EDR telemetry)\n\n### Cloud identity (Azure/Entra)\n- Sign-in logs (interactive/non-interactive)\n- Audit logs (MFA changes, credential registration, risky sign-in signals)\n\n## Detection hypotheses (examples)\n- If an attacker is dumping creds, we will see suspicious processes interacting with LSASS or known dumping tooling patterns.\n- If an attacker uses PowerShell to stage credential theft, we will see encoded commands, unusual parents, or suspicious download/execute patterns.\n- If an attacker is password spraying, we will see many failures across many accounts from a small set of IPs, often with consistent user-agent patterns.\n\n## Assumptions / blind spots\n- Without process creation logs, host-based detections degrade significantly.\n- Without PowerShell logging, many fileless techniques become harder to detect.\n- Attackers can evade naive detections via renamed binaries, living-off-the-land, or EDR bypasses.\n\n## Validation plan (lab)\n- Use Atomic Red Team tests for representative techniques\n- Generate endpoint telemetry in a Windows VM with Sysmon\n- Confirm detections fire and document false positives\n\n"
      }
    },
    "initial-access": {
      "coverage": {
        "path": "attacker-objectives\\initial-access\\coverage.md",
        "content": "# Initial Access Detection Coverage\n\nThis document tracks detection coverage for Initial Access scenarios, focusing on early trust boundary crossings and attempted access paths into the environment.\n\n| Technique / Scenario                                   | Detection                                      | Status       | Notes                                                                 |\n|--------------------------------------------------------|------------------------------------------------|--------------|-----------------------------------------------------------------------|\n| First-time privileged access from new network          | First-Time WordPress Admin Login from New Network | Documented   | Surfaces new authenticated admin access paths requiring analyst triage |\n| Exploit attempt against public-facing application      | Apache HTTP Server Path Traversal Attempt       | Documented   | Network-based exploit-pattern detection for attempted initial access   |\n"
      },
      "detections": {
        "identity": {
          "first-time-wp-admin-login-from-new-network": {
            "path": "attacker-objectives\\initial-access\\detections\\identity\\first-time-wp-admin-login-from-new-network.md",
            "content": "# Detection: First-Time WordPress Admin Login from New Network\n\n## Objective\nInitial Access\n\n## Detection Goal\nReduce uncertainty around new trust boundary crossings into privileged WordPress administration.\n\n## Hypothesis\nIf this detection fires, a previously untrusted network has successfully authenticated to a privileged WordPress admin interface.\n\n## What This Detection Does NOT Claim\n- This detection does not claim malicious intent.\n- This detection does not determine disposition.\n- This detection does not assert credential compromise.\n\n## Decision This Detection Forces\nIs this authenticated admin access from a new network expected and authorized, or does it represent unauthorized initial access that requires containment?\n\n## Why This Matters\nInitial Access often occurs through valid credentials and appears legitimate.\nSurfacing first-time authenticated access from new networks forces early decisions before further attacker actions occur.\n\n## Signals That Increase Confidence\n- Source IP, ASN, or network associated with known malicious infrastructure\n- Authentication from a geographic location never previously associated with WordPress administration\n- Immediate follow-on privileged actions (e.g., plugin installation, user creation)\n\n## Signals That Reduce Confidence\n- Confirmed administrator travel or remote work\n- First-time use of a corporate or personal VPN by an existing administrator\n- Change management or onboarding context\n\n## Assumptions and Blind Spots\n- Assumes successful authentication events are reliably logged\n- Does not detect attacks that originate from previously trusted networks\n- Does not differentiate between stolen credentials and legitimate credential use\n"
          }
        },
        "network": {
          "apache_path_traversal_attempt": {
            "path": "attacker-objectives\\initial-access\\detections\\network\\apache_path_traversal_attempt.md",
            "content": "# Detection: Apache HTTP Server Path Traversal Attempt\n\n## Detection Summary\nThis detection surfaces network traffic exhibiting URL path structures consistent with path traversal behavior, for analyst review.\n\n## ATT&CK Mapping\nT1190 – Exploit Public-Facing Application\n\n## Attacker Behavior\n- Attackers manipulate the URL structure of HTTP requests to influence how a server processes the request.\n\n- This technique is commonly used to attempt to interact with unintended paths or resources.\n\n- This behavior is typically observed during initial access stages of an intrusion.\n\n\n## What This Detection Claims\nIf this detection fires, it indicates that:\n\n- Network traffic originating from an external source was observed targeting an internal, public-facing resource\n  \n- The observed traffic contained URL path structures consistent with path traversal behavior\n\n## What This Detection Does NOT Claim\n- The observed traffic was malicious in intent\n  \n- The path traversal behavior was successful\n  \n- The targeted system or application was compromised\n\n## Required Telemetry\n- Network traffic inspection with visibility into inbound HTTP requests\n  \n- HTTP request parsing, including URL paths and request methods\n  \n- Sensor placement positioned to observe traffic targeting public-facing services\n\n## Analyst Decisions Required\n- Is this traffic expected?\n  \n- Was the request accepted or otherwise handled by the application, as evidenced by observable responses?\n\n## Confidence-Building Signals\n- The source IP address is associated with known scanning, exploitation, or adversary infrastructure based on threat intelligence\n  \n- The targeted service is known to be running a version affected by the referenced path traversal vulnerability, based on asset inventory or service fingerprinting\n  \n- Repeated or patterned path traversal requests are observed against the same resource or across multiple paths over a short time window\n\n## Known Limitations\n- This detection does not confirm whether the request resulted in access to specific files or resources, as it is based on network request patterns rather than application-level outcomes.\n  \n- This detection may surface benign activity, such as vulnerability scanning, security testing, or misconfigured clients, that exhibits similar URL path manipulation patterns.\n  \n- This detection is dependent on network sensor placement and visibility; path traversal attempts that bypass inspected network paths (e.g., direct cloud service access, encrypted traffic without inspection, or alternate ingress points) may not be observed.\n"
          }
        },
        "README": {
          "path": "attacker-objectives\\initial-access\\detections\\README.md",
          "content": "# Initial Access Detections\n\nThis directory contains individual detections designed to surface early trust boundary crossings that may represent Initial Access.\n"
        }
      },
      "README": {
        "path": "attacker-objectives\\initial-access\\README.md",
        "content": "# Initial Access\n\nThis section contains detections focused on identifying the first successful trust boundary crossings into the environment.\n"
      },
      "threat-model": {
        "path": "attacker-objectives\\initial-access\\threat-model.md",
        "content": "# Initial Access Threat Model\n\n## Objective\nIdentify the first successful trust boundary crossings from external actors into internal systems.\n\n## What Initial Access Means Here\nInitial Access occurs when an external actor successfully authenticates to or interacts with an internal resource in a way that was not previously expected.\n\n## Assumptions\n- External access paths to internal systems exist\n- Authentication events are logged with sufficient context\n- Legitimate users may occasionally access from new locations or networks\n\n## Common Initial Access Patterns\n- First-time authentication from a new network\n- Access to internal administrative interfaces from the internet\n- Valid credential use that appears legitimate but is contextually abnormal\n\n## Out of Scope\n- Post-authentication activity (Persistence, Lateral Movement)\n- Credential theft mechanics\n- Malware execution after access is obtained\n"
      }
    },
    "pre-intrusion": {
      "detections": {
        "external_email_with_malicious_link_delivered": {
          "path": "attacker-objectives\\pre-intrusion\\detections\\external_email_with_malicious_link_delivered.md",
          "content": "# Detection: External Email with External Link Delivered\n\n## Detection Summary\nThis detection surfaces external emails delivered to user inboxes that contain hyperlinks to external domains, which may represent a potential pathway to initial access, for analyst review.\n\n## ATT&CK Mapping\nNone  \n(Pre-Intrusion behavioral indicator; email delivery alone does not establish attacker access.)\n\n## Attacker Behavior\n- Email links are commonly used by attackers to direct users to external infrastructure they control or have compromised.\n\n- Such links may be used to facilitate credential harvesting, session abuse, or delivery of additional content.\n\n- This activity is frequently observed as an early stage of intrusion campaigns.\n\n## What This Detection Claims\nIf this detection fires, it indicates that:\n- An external email was successfully delivered to a user’s inbox\n\n- The delivered email contained a hyperlink directing to an external domain\n\n\n## What This Detection Does NOT Claim\n- The presence of the email indicates a user account compromise\n\n- The user interacted with the hyperlink contained in the email\n\n- Any credentials, sessions, or systems were accessed as a result of this email\n\n\n## Required Telemetry\n- Email delivery telemetry indicating successful delivery to a user inbox\n\n- Visibility into email message metadata and content, including embedded hyperlinks\n\n- Association of the delivered email with a recipient user account\n\n\n## Analyst Decisions Required\n- Is this email and its embedded external hyperlink expected for the recipient user or their role?\n  \n- Are the external hyperlinks benign or malicious?\n\n\n## Confidence-Building Signals\n- The domain referenced by the embedded hyperlink is associated with known malicious or suspicious activity based on domain reputation or threat intelligence\n  \n- User interaction with the embedded hyperlink is observed following email delivery\n  \n- The hyperlink was not rewritten or otherwise mitigated by email security controls prior to user interaction\n\n\n## Known Limitations\n- This detection does not analyze the content of the embedded hyperlink or the destination domain beyond its presence in the email\n  \n- External emails containing hyperlinks are common in legitimate business communications and may result in benign activity being surfaced\n  \n- This detection is limited to email delivery telemetry and does not confirm user interaction or downstream impact without additional correlated signals\n"
        },
        "javascript_obfuscation_observed": {
          "path": "attacker-objectives\\pre-intrusion\\detections\\javascript_obfuscation_observed.md",
          "content": "# Detection: JavaScript Obfuscation Observed in Web Traffic\n\n## Detection Summary\nThis detection surfaces web traffic in which JavaScript content exhibits characteristics consistent with obfuscation, for analyst review.\n\n## ATT&CK Mapping\nNone  \n(Behavioral indicator only; requires additional correlation to support ATT&CK objective placement.)\n\n## Attacker Behavior\n- Attackers may obfuscate JavaScript to hinder human analysis and reverse engineering of code logic.\n\n- JavaScript obfuscation is commonly used to evade simplistic or signature-based security controls that rely on readable content.\n\n- Obfuscated JavaScript is often observed as part of content delivery mechanisms in malicious campaigns, but is not inherently malicious on its own.\n\n## What This Detection Claims\nIf this detection fires, it indicates that:\n- Obfuscated JavaScript content was observed in web traffic\n\n- The obfuscated JavaScript was delivered to a client as part of a web session\n\n## What This Detection Does NOT Claim\n- The observed JavaScript was malicious in intent\n\n- The JavaScript content was executed on the client\n\n- The client system was compromised as a result of this activity\n\n## Required Telemetry\n- Network or proxy-level visibility into web traffic\n\n- Inspection or analysis capability for JavaScript content within web responses\n\n- Association of observed web traffic with a client session or user context \n\n## Analyst Decisions Required\n- Is the observed obfuscated JavaScript expected for the destination or application?\n\n- Does this activity correlate with additional signals indicating exploit delivery or execution?\n  \n## Confidence-Building Signals\n- The destination IP or domain is associated with known malicious or suspicious infrastructure based on threat intelligence\n\n- Additional web activity such as redirects, exploit attempts, or staged content delivery is observed following the initial JavaScript response\n\n- Correlated endpoint or identity telemetry indicates anomalous behavior following the web session\n\n## Known Limitations\n- This detection does not examine or deobfuscate the JavaScript payload; it only identifies characteristics consistent with obfuscation\n  \n- Obfuscated JavaScript is frequently observed in legitimate web traffic, which may result in benign activity being surfaced\n  \n- This detection is dependent on network or proxy visibility and may miss obfuscated content delivered through encrypted or uninspected channels\n\n"
        }
      },
      "README": {
        "path": "attacker-objectives\\pre-intrusion\\README.md",
        "content": "# Pre-Intrusion Objectives\n\nThis section contains detections that surface **observable behaviors** which may support intrusion hypotheses but **do not independently establish attacker intent, access, or success**.\n\nDetections in this category are intentionally scoped to:\n- Highlight ambiguous or early indicators\n- Avoid premature ATT&CK mapping\n- Require analyst judgment and additional correlation\n\nThese detections are **not sufficient on their own** to justify incident declaration or containment actions. They exist to inform investigation, not determine disposition.\n\nWhen correlated with stronger signals, Pre-Intrusion detections may contribute to higher-confidence attacker objective assessments.\n"
      }
    }
  },
  "detection-templates": {
    "generic_detection_template": {
      "path": "detection-templates\\generic_detection_template.md",
      "content": "# Detection: Name Here\n\n## Detection Summary\nSummary here\n\n## ATT&CK Mapping\nmapping here\n\n## Attacker Behavior\n- \n\n- \n\n- \n\n## What This Detection Claims\nIf this detection fires, it indicates that:\n- \n- \n\n## What This Detection Does NOT Claim\n- \n- \n- \n\n## Required Telemetry\n- \n- \n- \n\n## Analyst Decisions Required\n- \n- \n\n## Confidence-Building Signals\n- \n- \n- \n\n## Known Limitations\n- \n- \n- \n"
    },
    "README": {
      "path": "detection-templates\\README.md",
      "content": "# Detection Templates\n\nThis directory contains reusable detection design templates used to standardize\nhow detections are documented in this repository.\n\nThese templates focus on:\n- Attacker behavior and hypotheses\n- Required telemetry and assumptions\n- High-level detection logic\n- Explicit limitations and blind spots\n\nThey intentionally exclude:\n- Vendor-specific query logic\n- SPL, KQL, or production-ready Sigma rules\n\nTemplates are used as scaffolding to create individual detection write-ups\nlocated in the `/detections/` directory.\n"
    }
  },
  "methodology": {
    "README": {
      "path": "methodology\\README.md",
      "content": "# Methodology\n\n## Detection engineering lifecycle (simple version)\n1. Define attacker objective (what the adversary is trying to achieve)\n2. Map to ATT&CK techniques (how they do it)\n3. Identify required telemetry (what you must be able to observe)\n4. Write a detection hypothesis (what behavior should exist if the technique occurs)\n5. Implement detection logic (Sigma/SPL/KQL)\n6. Document assumptions + blind spots (where this will fail)\n7. Validate with real technique simulation (Atomic Red Team / scripts / lab activity)\n8. Track coverage + tune (measure quality over time)\n\n## Output expectations\nEvery detection should include:\n- ATT&CK technique mapping\n- Data sources required\n- Why the logic works (in plain English)\n- Known limitations and false positive risks\n- How it was validated\n\n"
    }
  },
  "README": {
    "path": "README.md",
    "content": "# Detection Notebook\n\nThis repository is a **public detection engineering notebook** that documents how I think through, design, and reason about detections using a threat-informed approach.\n\nIt focuses on **detection logic, assumptions, tradeoffs, and analyst decision-making**, rather than deployable production rules.\n\n---\n\n## What this repo shows\n\n- Threat-model-driven detection design (starting from attacker goals, not alerts)\n- MITRE ATT&CK mapping and **conceptual** coverage tracking\n- **Example** detection logic representations (Sigma / SPL / KQL) for illustration\n- Explicit assumptions, limitations, and analyst validation considerations\n\n---\n\n## Structure\n\n- `methodology/` — how I approach detection engineering end-to-end (thinking, not tooling)\n\n- `attacker-objectives/` — detection write-ups organized by attacker goals, including:\n  - attacker behavior\n  - detection claims and non-claims\n  - analyst decision points\n  - coverage considerations\n\n\n---\n\n## Scope and Disclosure\n\nThis repository **does not contain production-ready detections** and is **not intended for direct deployment** in any environment.\n\nAny example logic included is:\n- intentionally incomplete or underspecified\n- platform-agnostic where possible\n- provided to illustrate *detection reasoning*, not operational tuning\n\nThis notebook is designed to demonstrate **how detections are thought about**, not to expose or replicate live security controls.\n"
  }
};